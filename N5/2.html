<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 ë‹¨ì–´ í€´ì¦ˆ 2 (ë™ì‚¬/í˜•ìš©ì‚¬)</title>
    
    <style>
        /* --- ì¶”ê°€ëœ ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */
        .back-link {
            display: inline-block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #34495e;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            transition: 0.3s;
            text-align: center;
        }
        .back-link:hover { background-color: #2c3e50; transform: translateY(-2px); }
        .top-bar { text-align: center; background-color: #f4f7f6; padding-top: 10px; }

        /* --- ê¸°ì¡´ ìˆ˜í›ˆë‹˜ CSS ì½”ë“œ --- */
        /* 2. ë‹¨ì–´ í€´ì¦ˆ ì „ìš© ë˜í¼ (Part 2) */
        #jp-wordquiz-wrapper-2 {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* ì˜¤íƒ€ ìˆ˜ì •ë¨ */
            padding: 40px 20px;
            border-radius: 10px;
            margin: 0 auto 30px auto; /* ì¤‘ì•™ ì •ë ¬ */
            max-width: 800px;
            position: relative;
            
            /* ë³€ìˆ˜ ì„¤ì • */
            --max-width: 450px;
            --q-font: 60px;
            --opt-font: 18px;
            --opt-padding: 15px;
            --hint-height: 35px;
        }

        /* ì‚¬ì´ì¦ˆë³„ í´ë˜ìŠ¤ */
        #jp-wordquiz-wrapper-2.size-small { --max-width: 350px; --q-font: 45px; --opt-font: 14px; --opt-padding: 10px; --hint-height: 30px; }
        #jp-wordquiz-wrapper-2.size-large { --max-width: 700px; --q-font: 90px; --opt-font: 24px; --opt-padding: 20px; --hint-height: 50px; }

        /* ë‚´ë¶€ ì»¨í…Œì´ë„ˆ */
        #jp-wordquiz-wrapper-2 .quiz-container {
            background-color: #34495e; padding: 30px; border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); text-align: center;
            width: 100%; max-width: var(--max-width); position: relative; transition: max-width 0.3s; box-sizing: border-box;
        }

        /* íƒ€ì´í‹€ */
        #jp-wordquiz-wrapper-2 h2.game-title { margin-top: 25px; font-size: 24px; color: #ecf0f1; border: none; margin-bottom: 5px; }
        .game-subtitle { font-size: 16px; color: #e67e22; margin-bottom: 15px; font-weight: bold; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .size-controls, .set-controls { display: flex; gap: 5px; }
        .ctrl-btn { background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); color: #bdc3c7; padding: 5px 10px; font-size: 12px; cursor: pointer; border-radius: 4px; }
        .ctrl-btn:hover { background: rgba(0,0,0,0.5); color: white; }
        .ctrl-btn.active { background: #3498db; color: white; border-color: #3498db; }
        .set-btn.active { background: #e67e22; border-color: #e67e22; color: white; }

        /* ìƒíƒœë°” */
        .quiz-status-bar { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 16px; color: #bdc3c7; background: rgba(0,0,0,0.2); padding: 12px; border-radius: 8px; }
        .highlight { color: #f1c40f; font-weight: bold; }

        /* ë¬¸ì œ ì˜ì—­ (ë‹¨ì–´ + ìŠ¤í”¼ì»¤) */
        .question-area { display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0 5px 0; }
        .question-box { font-size: var(--q-font); font-weight: bold; min-height: calc(var(--q-font) * 1.5); color: #ecf0f1; text-shadow: 2px 2px 5px rgba(0,0,0,0.3); line-height: 1.2; }

        /* ìŠ¤í”¼ì»¤ ë²„íŠ¼ */
        .audio-btn { background: #ecf0f1; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.1s; color: #2c3e50; }
        .audio-btn:active { transform: scale(0.9); }
        .audio-btn:hover { background: #bdc3c7; }
        
        /* íŒíŠ¸ ì˜ì—­ */
        .question-yomi { font-size: calc(var(--opt-font) + 4px); color: #f39c12; margin-bottom: 20px; height: var(--hint-height); font-weight: bold; transition: opacity 0.3s; }

        /* ë³´ê¸° ë²„íŠ¼ ì˜ì—­ */
        .options-grid { display: flex; flex-direction: column; gap: 12px; }
        .option-btn { background-color: #ecf0f1; color: #2c3e50; border: none; padding: var(--opt-padding); font-size: var(--opt-font); border-radius: 8px; cursor: pointer; transition: all 0.1s; font-weight: bold; position: relative; }
        .option-btn:hover { background-color: #bdc3c7; transform: translateY(-2px); }
        .option-btn.correct { background-color: #2ecc71 !important; color: white; transform: scale(1.02); }
        .option-btn.wrong { background-color: #e74c3c !important; color: white; opacity: 0.6; cursor: not-allowed; }
        .disabled-area { pointer-events: none; }

        /* ê²°ê³¼ í™”ë©´ */
        #quizResultScreen_2 { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(44, 62, 80, 0.98); border-radius: 15px; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        #quizResultScreen_2 h2 { font-size: 32px; margin-bottom: 10px; color: #2ecc71; border: none;}
        .result-stat { font-size: 20px; margin: 5px 0; color: white; }
        
        .mistake-log-container { margin-top: 15px; width: 90%; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; max-height: 200px; overflow-y: auto; text-align: left; }
        .mistake-item { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px 0; font-size: 15px; color: #bdc3c7; }
        .mistake-jp { color: #e74c3c; font-weight: bold; margin-right: 8px;}
        
        .restart-btn { margin-top: 25px; padding: 12px 30px; font-size: 18px; background-color: #e67e22; color: white; border: none; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body style="background-color: #f4f7f6; margin: 0; padding: 0;">

    <div class="top-bar">
        <a href="../index.html" class="back-link">ğŸ”™ ë©”ì¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div id="jp-wordquiz-wrapper-2">
        <div class="quiz-container">
            
            <div class="control-panel">
                <div class="set-controls">
                    <button class="ctrl-btn set-btn active" onclick="changeSet_2(1)">Set 1</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_2(2)">Set 2</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_2(3)">Set 3</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_2(4)">Set 4</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_2(5)">Set 5</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_2('all')">ALL</button>
                </div>
                <div class="size-controls">
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_2('small')">ì‘ê²Œ</button>
                    <button class="ctrl-btn size-btn active" onclick="setQuizSize_2('medium')" id="btnQuizMedium_2">ë³´í†µ</button>
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_2('large')">í¬ê²Œ</button>
                </div>
            </div>

            <h2 class="game-title">ğŸ‡¯ğŸ‡µ JLPT N5 ë‹¨ì–´ì¥</h2>
            <div class="game-subtitle" id="setSubtitle_2">[ Set 1 : ì‹œì‘í•˜ê¸° ]</div>

            <div class="quiz-status-bar">
                <span>ì§„í–‰: <span id="quizProgress_2" class="highlight" style="color:#2ecc71">0 / 0</span></span>
                <span>ì ìˆ˜: <span id="quizScore_2" class="highlight">0</span></span>
            </div>

            <div class="question-area">
                <div class="question-box" id="quizQuestionText_2">???</div>
                <button class="audio-btn" onclick="speak_2()" title="ë‹¨ì–´ ë“£ê¸°">ğŸ”Š</button>
            </div>
            
            <div class="question-yomi" id="quizHintBox_2"></div>

            <div class="options-grid" id="quizOptionsArea_2"></div>

            <div id="quizResultScreen_2">
                <h2>ğŸ‰ í€´ì¦ˆ ì™„ë£Œ! ğŸ‰</h2>
                <div class="result-stat">ìµœì¢… ì ìˆ˜: <b id="finalQuizScore_2" style="color:#f1c40f">0</b></div>
                <div class="result-stat">ë§ì¶˜ ê°œìˆ˜: <b id="finalQuizProgress_2">0 / 0</b></div>
                
                <div class="mistake-log-container">
                    <div style="font-size:14px; color:#e74c3c; text-align:center; margin-bottom:5px;">â–¼ í‹€ë¦° ë‹¨ì–´ ë³µìŠµ â–¼</div>
                    <div id="quizMistakeList_2"></div>
                </div>

                <button class="restart-btn" onclick="initQuizGame_2()">ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // 2íƒ„: ë™ì‚¬ & í˜•ìš©ì‚¬ 100ì„ 
        const wordQuizDB_2 = [
            // Set 1: ì´(ã„)í˜•ìš©ì‚¬ 1 (1-20)
            { jp: 'ãŠãŠãã„', mean: 'í¬ë‹¤', yomi: 'ookii', set: 1 }, { jp: 'ã¡ã„ã•ã„', mean: 'ì‘ë‹¤', yomi: 'chiisai', set: 1 }, { jp: 'ãŸã‹ã„', mean: 'ë¹„ì‹¸ë‹¤/ë†’ë‹¤', yomi: 'takai', set: 1 }, { jp: 'ã‚„ã™ã„', mean: 'ì‹¸ë‹¤', yomi: 'yasui', set: 1 }, { jp: 'ã‚ãŸã‚‰ã—ã„', mean: 'ìƒˆë¡­ë‹¤(ìƒˆê²ƒ)', yomi: 'atarashii', set: 1 }, { jp: 'ãµã‚‹ã„', mean: 'ë‚¡ë‹¤(í—Œê²ƒ)', yomi: 'furui', set: 1 }, { jp: 'ã„ã„', mean: 'ì¢‹ë‹¤', yomi: 'ii', set: 1 }, { jp: 'ã‚ã‚‹ã„', mean: 'ë‚˜ì˜ë‹¤', yomi: 'warui', set: 1 }, { jp: 'ãŠã„ã—ã„', mean: 'ë§›ìˆë‹¤', yomi: 'oishii', set: 1 }, { jp: 'ã¾ãšã„', mean: 'ë§›ì—†ë‹¤', yomi: 'mazui', set: 1 }, { jp: 'ã‚ã¤ã„', mean: 'ë¥ë‹¤/ëœ¨ê²ë‹¤', yomi: 'atsui', set: 1 }, { jp: 'ã•ã‚€ã„', mean: 'ì¶¥ë‹¤', yomi: 'samui', set: 1 }, { jp: 'ã¤ã‚ãŸã„', mean: 'ì°¨ê°‘ë‹¤', yomi: 'tsumetai', set: 1 }, { jp: 'ã‚€ãšã‹ã—ã„', mean: 'ì–´ë µë‹¤', yomi: 'muzukashii', set: 1 }, { jp: 'ã‚„ã•ã—ã„', mean: 'ì‰½ë‹¤/ìƒëƒ¥í•˜ë‹¤', yomi: 'yasashii', set: 1 }, { jp: 'ãŠã‚‚ã—ã‚ã„', mean: 'ì¬ë¯¸ìˆë‹¤', yomi: 'omoshiroi', set: 1 }, { jp: 'ã¤ã¾ã‚‰ãªã„', mean: 'ì§€ë£¨í•˜ë‹¤', yomi: 'tsumaranai', set: 1 }, { jp: 'ãŸã®ã—ã„', mean: 'ì¦ê²ë‹¤', yomi: 'tanoshii', set: 1 }, { jp: 'ã„ããŒã—ã„', mean: 'ë°”ì˜ë‹¤', yomi: 'isogashii', set: 1 }, { jp: 'ã²ã‚ã„', mean: 'ë„“ë‹¤', yomi: 'hiroi', set: 1 },
            // Set 2: ì´(ã„)í˜•ìš©ì‚¬ 2 & ë‚˜(ãª)í˜•ìš©ì‚¬ (21-40)
            { jp: 'ã›ã¾ã„', mean: 'ì¢ë‹¤', yomi: 'semai', set: 2 }, { jp: 'ã¡ã‹ã„', mean: 'ê°€ê¹ë‹¤', yomi: 'chikai', set: 2 }, { jp: 'ã¨ãŠã„', mean: 'ë©€ë‹¤', yomi: 'tooi', set: 2 }, { jp: 'ãªãŒã„', mean: 'ê¸¸ë‹¤', yomi: 'nagai', set: 2 }, { jp: 'ã¿ã˜ã‹ã„', mean: 'ì§§ë‹¤', yomi: 'mijikai', set: 2 }, { jp: 'ã¯ã‚„ã„', mean: 'ë¹ ë¥´ë‹¤/ì´ë¥´ë‹¤', yomi: 'hayai', set: 2 }, { jp: 'ãŠãã„', mean: 'ëŠë¦¬ë‹¤/ëŠ¦ë‹¤', yomi: 'osoi', set: 2 }, { jp: 'ã‚ã‹ã‚‹ã„', mean: 'ë°ë‹¤', yomi: 'akarui', set: 2 }, { jp: 'ãã‚‰ã„', mean: 'ì–´ë‘¡ë‹¤', yomi: 'kurai', set: 2 }, { jp: 'ã‚ãŠã„', mean: 'íŒŒë—ë‹¤', yomi: 'aoi', set: 2 }, { jp: 'ã™ãã ', mean: 'ì¢‹ì•„í•˜ë‹¤', yomi: 'sukida', set: 2 }, { jp: 'ãã‚‰ã„ã ', mean: 'ì‹«ì–´í•˜ë‹¤', yomi: 'kiraida', set: 2 }, { jp: 'ãã‚Œã„ã ', mean: 'ì˜ˆì˜ë‹¤/ê¹¨ë—í•˜ë‹¤', yomi: 'kireida', set: 2 }, { jp: 'ã’ã‚“ãã ', mean: 'ê±´ê°•í•˜ë‹¤', yomi: 'genkida', set: 2 }, { jp: 'ã—ãšã‹ã ', mean: 'ì¡°ìš©í•˜ë‹¤', yomi: 'shizukada', set: 2 }, { jp: 'ã«ãã‚„ã‹ã ', mean: 'ë²ˆí™”í•˜ë‹¤', yomi: 'nigiyakada', set: 2 }, { jp: 'ã‚†ã†ã‚ã„ã ', mean: 'ìœ ëª…í•˜ë‹¤', yomi: 'yuumeida', set: 2 }, { jp: 'ã—ã‚“ã›ã¤ã ', mean: 'ì¹œì ˆí•˜ë‹¤', yomi: 'shinsetsu', set: 2 }, { jp: 'ã²ã¾ã ', mean: 'í•œê°€í•˜ë‹¤', yomi: 'himada', set: 2 }, { jp: 'ã˜ã‚‡ã†ãšã ', mean: 'ì˜í•˜ë‹¤', yomi: 'jouzuda', set: 2 },
            // Set 3: ë™ì‚¬ - ì´ë™/ì¡´ì¬/ìƒí™œ (41-60)
            { jp: 'ã„ã', mean: 'ê°€ë‹¤', yomi: 'iku', set: 3 }, { jp: 'ãã‚‹', mean: 'ì˜¤ë‹¤', yomi: 'kuru', set: 3 }, { jp: 'ã‹ãˆã‚‹', mean: 'ëŒì•„ê°€ë‹¤', yomi: 'kaeru', set: 3 }, { jp: 'ã‚ã‚‹', mean: 'ìˆë‹¤ (ì‚¬ë¬¼)', yomi: 'aru', set: 3 }, { jp: 'ã„ã‚‹', mean: 'ìˆë‹¤ (ì‚¬ëŒ)', yomi: 'iru', set: 3 }, { jp: 'ãŠãã‚‹', mean: 'ì¼ì–´ë‚˜ë‹¤', yomi: 'okiru', set: 3 }, { jp: 'ã­ã‚‹', mean: 'ìë‹¤', yomi: 'neru', set: 3 }, { jp: 'ã¯ã„ã‚‹', mean: 'ë“¤ì–´ê°€ë‹¤', yomi: 'hairu', set: 3 }, { jp: 'ã§ã‚‹', mean: 'ë‚˜ê°€ë‹¤/ë‚˜ì˜¤ë‹¤', yomi: 'deru', set: 3 }, { jp: 'ã®ã‚‹', mean: 'íƒ€ë‹¤', yomi: 'noru', set: 3 }, { jp: 'ãŸã¹ã‚‹', mean: 'ë¨¹ë‹¤', yomi: 'taberu', set: 3 }, { jp: 'ã®ã‚€', mean: 'ë§ˆì‹œë‹¤', yomi: 'nomu', set: 3 }, { jp: 'ã¿ã‚‹', mean: 'ë³´ë‹¤', yomi: 'miru', set: 3 }, { jp: 'ãã', mean: 'ë“£ë‹¤', yomi: 'kiku', set: 3 }, { jp: 'ã‚ˆã‚€', mean: 'ì½ë‹¤', yomi: 'yomu', set: 3 }, { jp: 'ã‹ã', mean: 'ì“°ë‹¤', yomi: 'kaku', set: 3 }, { jp: 'ã¯ãªã™', mean: 'ë§í•˜ë‹¤', yomi: 'hanasu', set: 3 }, { jp: 'ã¹ã‚“ãã‚‡ã†ã™ã‚‹', mean: 'ê³µë¶€í•˜ë‹¤', yomi: 'benkyousuru', set: 3 }, { jp: 'ã‹ã†', mean: 'ì‚¬ë‹¤', yomi: 'kau', set: 3 }, { jp: 'ã¾ã¤', mean: 'ê¸°ë‹¤ë¦¬ë‹¤', yomi: 'matsu', set: 3 },
            // Set 4: ë™ì‚¬ - ë™ì‘ 1 (61-80)
            { jp: 'ã‚ã‹ã‚‹', mean: 'ì•Œë‹¤/ì´í•´í•˜ë‹¤', yomi: 'wakaru', set: 4 }, { jp: 'ã™ã‚‹', mean: 'í•˜ë‹¤', yomi: 'suru', set: 4 }, { jp: 'ã‚ã†', mean: 'ë§Œë‚˜ë‹¤', yomi: 'au', set: 4 }, { jp: 'ã‚ãã¶', mean: 'ë†€ë‹¤', yomi: 'asobu', set: 4 }, { jp: 'ãŠã‚ˆã', mean: 'í—¤ì—„ì¹˜ë‹¤', yomi: 'oyogu', set: 4 }, { jp: 'ã†ãŸã†', mean: 'ë…¸ë˜í•˜ë‹¤', yomi: 'utau', set: 4 }, { jp: 'ã‚ã‚‹ã', mean: 'ê±·ë‹¤', yomi: 'aruku', set: 4 }, { jp: 'ã¯ã—ã‚‹', mean: 'ë‹¬ë¦¬ë‹¤', yomi: 'hashiru', set: 4 }, { jp: 'ãŸã¤', mean: 'ì„œë‹¤', yomi: 'tatsu', set: 4 }, { jp: 'ã™ã‚ã‚‹', mean: 'ì•‰ë‹¤', yomi: 'suwaru', set: 4 }, { jp: 'ã‚ã‘ã‚‹', mean: 'ì—´ë‹¤', yomi: 'akeru', set: 4 }, { jp: 'ã—ã‚ã‚‹', mean: 'ë‹«ë‹¤', yomi: 'shimeru', set: 4 }, { jp: 'ã¤ã‘ã‚‹', mean: 'ì¼œë‹¤/ë¶™ì´ë‹¤', yomi: 'tsukeru', set: 4 }, { jp: 'ã‘ã™', mean: 'ë„ë‹¤/ì§€ìš°ë‹¤', yomi: 'kesu', set: 4 }, { jp: 'ã¨ã‚‹', mean: 'ì§‘ë‹¤/ì°ë‹¤', yomi: 'toru', set: 4 }, { jp: 'ãŠã—ãˆã‚‹', mean: 'ê°€ë¥´ì¹˜ë‹¤', yomi: 'oshieru', set: 4 }, { jp: 'ãªã‚‰ã†', mean: 'ë°°ìš°ë‹¤', yomi: 'narau', set: 4 }, { jp: 'ã‹ã™', mean: 'ë¹Œë ¤ì£¼ë‹¤', yomi: 'kasu', set: 4 }, { jp: 'ã‹ã‚Šã‚‹', mean: 'ë¹Œë¦¬ë‹¤', yomi: 'kariru', set: 4 }, { jp: 'ã‚ã‚‰ã†', mean: 'ì”»ë‹¤', yomi: 'arau', set: 4 },
            // Set 5: ë™ì‚¬ - ë™ì‘ 2 (81-100)
            { jp: 'ã¯ãŸã‚‰ã', mean: 'ì¼í•˜ë‹¤', yomi: 'hataraku', set: 5 }, { jp: 'ã‚„ã™ã‚€', mean: 'ì‰¬ë‹¤', yomi: 'yasumu', set: 5 }, { jp: 'ã‚ˆã¶', mean: 'ë¶€ë¥´ë‹¤', yomi: 'yobu', set: 5 }, { jp: 'ã¤ãã‚‹', mean: 'ë§Œë“¤ë‹¤', yomi: 'tsukuru', set: 5 }, { jp: 'ã†ã‚‹', mean: 'íŒ”ë‹¤', yomi: 'uru', set: 5 }, { jp: 'ã—ã‚‹', mean: 'ì•Œë‹¤(ì§€ì‹)', yomi: 'shiru', set: 5 }, { jp: 'ã™ã‚€', mean: 'ì‚´ë‹¤(ê±°ì£¼)', yomi: 'sumu', set: 5 }, { jp: 'ã—ã¬', mean: 'ì£½ë‹¤', yomi: 'shinu', set: 5 }, { jp: 'ãã‚‹', mean: 'ì…ë‹¤(ìƒì˜)', yomi: 'kiru', set: 5 }, { jp: 'ã¬ã', mean: 'ë²—ë‹¤', yomi: 'nugu', set: 5 }, { jp: 'ã‹ã¶ã‚‹', mean: 'ì“°ë‹¤(ëª¨ì)', yomi: 'kaburu', set: 5 }, { jp: 'ã‹ã‘ã‚‹', mean: 'ì“°ë‹¤(ì•ˆê²½)', yomi: 'kakeru', set: 5 }, { jp: 'ã¯ã', mean: 'ì‹ ë‹¤/ì…ë‹¤(í•˜ì˜)', yomi: 'haku', set: 5 }, { jp: 'ã¯ã˜ã¾ã‚‹', mean: 'ì‹œì‘ë˜ë‹¤', yomi: 'hajimaru', set: 5 }, { jp: 'ãŠã‚ã‚‹', mean: 'ëë‚˜ë‹¤', yomi: 'owaru', set: 5 }, { jp: 'ã“ã¾ã‚‹', mean: 'ê³¤ë€í•˜ë‹¤', yomi: 'komaru', set: 5 }, { jp: 'ãªã', mean: 'ìš¸ë‹¤', yomi: 'naku', set: 5 }, { jp: 'ã‚ã‚‰ã†', mean: 'ì›ƒë‹¤', yomi: 'warau', set: 5 }, { jp: 'ã®ã¼ã‚‹', mean: 'ì˜¤ë¥´ë‹¤', yomi: 'noboru', set: 5 }, { jp: 'ãŠã‚Šã‚‹', mean: 'ë‚´ë¦¬ë‹¤', yomi: 'oriru', set: 5 }
        ];

        let quizDeck_2 = [];
        let currentQuiz_2 = null;
        let quizScore_2 = 0;
        let quizCorrectCount_2 = 0;
        let quizTotalCount_2 = 0;
        let quizWrongAnswers_2 = []; 
        let quizStartTime_2 = 0; 
        let quizMistakeCount_2 = 0; 
        let currentSet_2 = 1;

        const quizWrapper_2 = document.getElementById('jp-wordquiz-wrapper-2');
        const qText_2 = document.getElementById('quizQuestionText_2');
        const qHint_2 = document.getElementById('quizHintBox_2');
        const qOptions_2 = document.getElementById('quizOptionsArea_2');
        const qProgress_2 = document.getElementById('quizProgress_2');
        const qScore_2 = document.getElementById('quizScore_2');
        const qResult_2 = document.getElementById('quizResultScreen_2');
        const qMistakeList_2 = document.getElementById('quizMistakeList_2');
        const qSubtitle_2 = document.getElementById('setSubtitle_2');

        function setQuizSize_2(size) {
            quizWrapper_2.classList.remove('size-small', 'size-large');
            const buttons = quizWrapper_2.querySelectorAll('.size-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (size === 'small') {
                quizWrapper_2.classList.add('size-small');
                quizWrapper_2.querySelector("button[onclick=\"setQuizSize_2('small')\"]").classList.add('active');
            } else if (size === 'large') {
                quizWrapper_2.classList.add('size-large');
                quizWrapper_2.querySelector("button[onclick=\"setQuizSize_2('large')\"]").classList.add('active');
            } else {
                document.getElementById('btnQuizMedium_2').classList.add('active');
            }
        }

        function changeSet_2(set) {
            currentSet_2 = set;
            const setBtns = quizWrapper_2.querySelectorAll('.set-btn');
            setBtns.forEach(btn => btn.classList.remove('active'));
            
            if(set === 'all') {
                setBtns[5].classList.add('active');
                qSubtitle_2.innerText = `[ ì „ì²´ ë„ì „ : ì´ ${wordQuizDB_2.length}ë‹¨ì–´ ]`;
            } else {
                setBtns[set-1].classList.add('active');
                qSubtitle_2.innerText = `[ Set ${set} : ë‹¨ì–´ ${getSetRange_2(set)} ]`;
            }
            initQuizGame_2();
        }

        function getSetRange_2(set) {
            const start = (set - 1) * 20 + 1;
            const end = set * 20;
            return `${start}~${end}`;
        }

        function shuffleQuiz_2(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function initQuizGame_2() {
            let filteredDB = [];
            if (currentSet_2 === 'all') {
                filteredDB = [...wordQuizDB_2];
            } else {
                filteredDB = wordQuizDB_2.filter(item => item.set === currentSet_2);
            }

            quizDeck_2 = shuffleQuiz_2(filteredDB); 
            quizTotalCount_2 = quizDeck_2.length; 
            quizScore_2 = 0;
            quizCorrectCount_2 = 0;
            quizWrongAnswers_2 = [];
            qScore_2.innerText = quizScore_2;
            updateQuizProgress_2();
            qResult_2.style.display = 'none';
            nextQuizQuestion_2();
        }

        function updateQuizProgress_2() {
            qProgress_2.innerText = `${quizCorrectCount_2} / ${quizTotalCount_2}`;
        }

        function nextQuizQuestion_2() {
            if (quizDeck_2.length === 0) {
                endQuizGame_2();
                return;
            }
            qOptions_2.classList.remove('disabled-area');
            quizMistakeCount_2 = 0; 
            currentQuiz_2 = quizDeck_2.pop();
            qText_2.innerText = currentQuiz_2.jp;
            qHint_2.innerText = ""; 
            const options = generateQuizOptions_2(currentQuiz_2);
            renderQuizButtons_2(options);
            quizStartTime_2 = Date.now();
        }

        function generateQuizOptions_2(correctItem) {
            const otherWords = wordQuizDB_2.filter(w => w.jp !== correctItem.jp);
            const distractors = shuffleQuiz_2(otherWords).slice(0, 4);
            const finalOptions = [...distractors, correctItem];
            return shuffleQuiz_2(finalOptions);
        }

        function renderQuizButtons_2(options) {
            qOptions_2.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.mean;
                btn.onclick = () => checkQuizAnswer_2(btn, opt);
                qOptions_2.appendChild(btn);
            });
        }

        function checkQuizAnswer_2(btn, selectedOpt) {
            if (selectedOpt.jp === currentQuiz_2.jp) {
                qOptions_2.classList.add('disabled-area'); 
                btn.classList.add('correct');
                
                if (quizMistakeCount_2 === 0) {
                    const endTime = Date.now();
                    const timeTaken = (endTime - quizStartTime_2) / 1000; 
                    const point = Math.max(20, Math.floor(100 - (timeTaken * 5))); 
                    quizScore_2 += point;
                    quizCorrectCount_2++; 
                } else {
                    quizCorrectCount_2++; 
                }

                qScore_2.innerText = quizScore_2;
                updateQuizProgress_2(); 
                setTimeout(nextQuizQuestion_2, 500); 
            } else {
                btn.classList.add('wrong');
                btn.disabled = true; 
                
                if (quizMistakeCount_2 === 0) {
                    quizMistakeCount_2++;
                    qHint_2.innerText = `ğŸ’¡ íŒíŠ¸: ${currentQuiz_2.yomi}`;
                    if (!quizWrongAnswers_2.some(w => w.jp === currentQuiz_2.jp)) {
                        quizWrongAnswers_2.push(currentQuiz_2);
                    }
                } else {
                    qOptions_2.classList.add('disabled-area'); 
                    const allBtns = qOptions_2.querySelectorAll('.option-btn');
                    allBtns.forEach(b => {
                        if (b.innerText === currentQuiz_2.mean) b.classList.add('correct');
                    });
                    setTimeout(nextQuizQuestion_2, 1500);
                }
            }
        }

        function endQuizGame_2() {
            document.getElementById('finalQuizScore_2').innerText = quizScore_2;
            document.getElementById('finalQuizProgress_2').innerText = `${quizCorrectCount_2} / ${quizTotalCount_2}`;
            qMistakeList_2.innerHTML = '';
            if (quizWrongAnswers_2.length === 0) {
                qMistakeList_2.innerHTML = '<div style="color:#2ecc71; text-align:center; padding:20px;">ğŸ† ì™„ë²½í•©ë‹ˆë‹¤!</div>';
            } else {
                quizWrongAnswers_2.forEach(w => {
                    const item = document.createElement('div');
                    item.className = 'mistake-item';
                    item.innerHTML = `<span class="mistake-jp">${w.jp}</span> (${w.yomi}) : ${w.mean}`;
                    qMistakeList_2.appendChild(item);
                });
            }
            qResult_2.style.display = 'flex';
        }

        function speak_2() {
            if (!('speechSynthesis' in window)) {
                alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }
            const text = currentQuiz_2.jp;
            const utt = new SpeechSynthesisUtterance(text);
            utt.lang = 'ja-JP';
            utt.rate = 0.9; 

            const voices = window.speechSynthesis.getVoices();
            const jaVoice = voices.find(v => v.lang.includes('ja') || v.lang.includes('JP'));
            if (jaVoice) utt.voice = jaVoice;

            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utt);
        }

        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = function() { 
                window.speechSynthesis.getVoices(); 
            };
        }

        initQuizGame_2();
    </script>
</body>
</html>
