<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JLPT N5 ë‹¨ì–´ í€´ì¦ˆ 3 (íšŒí™”/í•„ìˆ˜í‘œí˜„)</title>
    
    <style>
        /* --- ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */
        .back-link {
            display: inline-block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #34495e;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            font-weight: bold;
            transition: 0.3s;
            text-align: center;
        }
        .back-link:hover { background-color: #2c3e50; transform: translateY(-2px); }
        .top-bar { text-align: center; background-color: #f4f7f6; padding-top: 10px; }

        /* --- ê¸°ì¡´ ìˆ˜í›ˆë‹˜ CSS ì½”ë“œ --- */
        /* 3. ë‹¨ì–´ í€´ì¦ˆ ì „ìš© ë˜í¼ (Part 3) */
        #jp-wordquiz-wrapper-3 {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* ì˜¤íƒ€ ìˆ˜ì •ë¨ */
            padding: 40px 20px;
            border-radius: 10px;
            margin: 0 auto 30px auto; /* ì¤‘ì•™ ì •ë ¬ */
            max-width: 800px;
            position: relative;
            
            /* ë³€ìˆ˜ ì„¤ì • */
            --max-width: 450px;
            --q-font: 55px; /* ë‹¨ì–´ê°€ ê¸¸ ìˆ˜ ìˆì–´ì„œ ì•½ê°„ ì¤„ì„ */
            --opt-font: 18px;
            --opt-padding: 15px;
            --hint-height: 35px;
        }

        /* ì‚¬ì´ì¦ˆë³„ í´ë˜ìŠ¤ */
        #jp-wordquiz-wrapper-3.size-small { --max-width: 350px; --q-font: 40px; --opt-font: 14px; --opt-padding: 10px; --hint-height: 30px; }
        #jp-wordquiz-wrapper-3.size-large { --max-width: 700px; --q-font: 80px; --opt-font: 24px; --opt-padding: 20px; --hint-height: 50px; }

        /* ë‚´ë¶€ ì»¨í…Œì´ë„ˆ */
        #jp-wordquiz-wrapper-3 .quiz-container {
            background-color: #34495e; padding: 30px; border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); text-align: center;
            width: 100%; max-width: var(--max-width); position: relative; transition: max-width 0.3s; box-sizing: border-box;
        }

        /* íƒ€ì´í‹€ */
        #jp-wordquiz-wrapper-3 h2.game-title { margin-top: 25px; font-size: 24px; color: #ecf0f1; border: none; margin-bottom: 5px; }
        .game-subtitle { font-size: 16px; color: #9b59b6; margin-bottom: 15px; font-weight: bold; }

        /* ì»¨íŠ¸ë¡¤ íŒ¨ë„ */
        .control-panel { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .size-controls, .set-controls { display: flex; gap: 5px; }
        .ctrl-btn { background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1); color: #bdc3c7; padding: 5px 10px; font-size: 12px; cursor: pointer; border-radius: 4px; }
        .ctrl-btn:hover { background: rgba(0,0,0,0.5); color: white; }
        .ctrl-btn.active { background: #3498db; color: white; border-color: #3498db; }
        .set-btn.active { background: #9b59b6; border-color: #9b59b6; color: white; }

        /* ìƒíƒœë°” */
        .quiz-status-bar { display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 16px; color: #bdc3c7; background: rgba(0,0,0,0.2); padding: 12px; border-radius: 8px; }
        .highlight { color: #f1c40f; font-weight: bold; }

        /* ë¬¸ì œ ì˜ì—­ (ë‹¨ì–´ + ìŠ¤í”¼ì»¤) */
        .question-area { display: flex; align-items: center; justify-content: center; gap: 10px; margin: 10px 0 5px 0; }
        .question-box { font-size: var(--q-font); font-weight: bold; min-height: calc(var(--q-font) * 1.5); color: #ecf0f1; text-shadow: 2px 2px 5px rgba(0,0,0,0.3); line-height: 1.2; }

        /* ìŠ¤í”¼ì»¤ ë²„íŠ¼ */
        .audio-btn { background: #ecf0f1; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: transform 0.1s; color: #2c3e50; }
        .audio-btn:active { transform: scale(0.9); }
        .audio-btn:hover { background: #bdc3c7; }
        
        /* íŒíŠ¸ ì˜ì—­ */
        .question-yomi { font-size: calc(var(--opt-font) + 4px); color: #f39c12; margin-bottom: 20px; height: var(--hint-height); font-weight: bold; transition: opacity 0.3s; }

        /* ë³´ê¸° ë²„íŠ¼ ì˜ì—­ */
        .options-grid { display: flex; flex-direction: column; gap: 12px; }
        .option-btn { background-color: #ecf0f1; color: #2c3e50; border: none; padding: var(--opt-padding); font-size: var(--opt-font); border-radius: 8px; cursor: pointer; transition: all 0.1s; font-weight: bold; position: relative; }
        .option-btn:hover { background-color: #bdc3c7; transform: translateY(-2px); }
        .option-btn.correct { background-color: #2ecc71 !important; color: white; transform: scale(1.02); }
        .option-btn.wrong { background-color: #e74c3c !important; color: white; opacity: 0.6; cursor: not-allowed; }
        .disabled-area { pointer-events: none; }

        /* ê²°ê³¼ í™”ë©´ */
        #quizResultScreen_3 { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(44, 62, 80, 0.98); border-radius: 15px; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        #quizResultScreen_3 h2 { font-size: 32px; margin-bottom: 10px; color: #2ecc71; border: none;}
        .result-stat { font-size: 20px; margin: 5px 0; color: white; }
        
        .mistake-log-container { margin-top: 15px; width: 90%; background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; max-height: 200px; overflow-y: auto; text-align: left; }
        .mistake-item { border-bottom: 1px solid rgba(255,255,255,0.1); padding: 8px 0; font-size: 15px; color: #bdc3c7; }
        .mistake-jp { color: #e74c3c; font-weight: bold; margin-right: 8px;}
        
        .restart-btn { margin-top: 25px; padding: 12px 30px; font-size: 18px; background-color: #e67e22; color: white; border: none; border-radius: 8px; cursor: pointer; }
    </style>
</head>
<body style="background-color: #f4f7f6; margin: 0; padding: 0;">

    <div class="top-bar">
        <a href="../index.html" class="back-link">ğŸ”™ ë©”ì¸ ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
    </div>

    <div id="jp-wordquiz-wrapper-3">
        <div class="quiz-container">
            
            <div class="control-panel">
                <div class="set-controls">
                    <button class="ctrl-btn set-btn active" onclick="changeSet_3(1)">Set 1</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_3(2)">Set 2</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_3(3)">Set 3</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_3(4)">Set 4</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_3(5)">Set 5</button>
                    <button class="ctrl-btn set-btn" onclick="changeSet_3('all')">ALL</button>
                </div>
                <div class="size-controls">
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_3('small')">ì‘ê²Œ</button>
                    <button class="ctrl-btn size-btn active" onclick="setQuizSize_3('medium')" id="btnQuizMedium_3">ë³´í†µ</button>
                    <button class="ctrl-btn size-btn" onclick="setQuizSize_3('large')">í¬ê²Œ</button>
                </div>
            </div>

            <h2 class="game-title">ğŸ‡¯ğŸ‡µ JLPT N5 ë‹¨ì–´ì¥</h2>
            <div class="game-subtitle" id="setSubtitle_3">[ Set 1 : ì‹œì‘í•˜ê¸° ]</div>

            <div class="quiz-status-bar">
                <span>ì§„í–‰: <span id="quizProgress_3" class="highlight" style="color:#2ecc71">0 / 0</span></span>
                <span>ì ìˆ˜: <span id="quizScore_3" class="highlight">0</span></span>
            </div>

            <div class="question-area">
                <div class="question-box" id="quizQuestionText_3">???</div>
                <button class="audio-btn" onclick="speak_3()" title="ë‹¨ì–´ ë“£ê¸°">ğŸ”Š</button>
            </div>
            
            <div class="question-yomi" id="quizHintBox_3"></div>

            <div class="options-grid" id="quizOptionsArea_3"></div>

            <div id="quizResultScreen_3">
                <h2>ğŸ‰ í€´ì¦ˆ ì™„ë£Œ! ğŸ‰</h2>
                <div class="result-stat">ìµœì¢… ì ìˆ˜: <b id="finalQuizScore_3" style="color:#f1c40f">0</b></div>
                <div class="result-stat">ë§ì¶˜ ê°œìˆ˜: <b id="finalQuizProgress_3">0 / 0</b></div>
                
                <div class="mistake-log-container">
                    <div style="font-size:14px; color:#e74c3c; text-align:center; margin-bottom:5px;">â–¼ í‹€ë¦° ë‹¨ì–´ ë³µìŠµ â–¼</div>
                    <div id="quizMistakeList_3"></div>
                </div>

                <button class="restart-btn" onclick="initQuizGame_3()">ë‹¤ì‹œ í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // 3íƒ„: íšŒí™” & í•„ìˆ˜ í‘œí˜„ (100ì„ )
        const wordQuizDB_3 = [
            // Set 1: ì¸ì‚¬/íšŒí™” 1 (1-20)
            { jp: 'ãŠã¯ã‚ˆã†', mean: 'ì•„ì¹¨ ì¸ì‚¬', yomi: 'ohayou', set: 1 }, { jp: 'ã“ã‚“ã«ã¡ã¯', mean: 'ì ì‹¬ ì¸ì‚¬ (ë‚®)', yomi: 'konnichiwa', set: 1 }, { jp: 'ã“ã‚“ã°ã‚“ã¯', mean: 'ì €ë… ì¸ì‚¬ (ë°¤)', yomi: 'konbanwa', set: 1 }, { jp: 'ã•ã‚ˆã†ãªã‚‰', mean: 'ì‘ë³„ ì¸ì‚¬ (ì•ˆë…•íˆ ê°€ì„¸ìš”)', yomi: 'sayounara', set: 1 }, { jp: 'ãŠã‚„ã™ã¿', mean: 'ì˜ ììš”', yomi: 'oyasumi', set: 1 }, { jp: 'ã‚ã‚ŠãŒã¨ã†', mean: 'ê³ ë§™ìŠµë‹ˆë‹¤', yomi: 'arigatou', set: 1 }, { jp: 'ã™ã¿ã¾ã›ã‚“', mean: 'ë¯¸ì•ˆí•©ë‹ˆë‹¤/ì €ê¸°ìš”', yomi: 'sumimasen', set: 1 }, { jp: 'ã”ã‚ã‚“ãªã•ã„', mean: 'ì£„ì†¡í•©ë‹ˆë‹¤', yomi: 'gomennasai', set: 1 }, { jp: 'ã„ãŸã ãã¾ã™', mean: 'ì˜ ë¨¹ê² ìŠµë‹ˆë‹¤', yomi: 'itadakimasu', set: 1 }, { jp: 'ã”ã¡ãã†ã•ã¾', mean: 'ì˜ ë¨¹ì—ˆìŠµë‹ˆë‹¤', yomi: 'gochisousama', set: 1 }, { jp: 'ã„ã£ã¦ãã¾ã™', mean: 'ë‹¤ë…€ì˜¤ê² ìŠµë‹ˆë‹¤', yomi: 'ittekimasu', set: 1 }, { jp: 'ã„ã£ã¦ã‚‰ã£ã—ã‚ƒã„', mean: 'ë‹¤ë…€ì˜¤ì„¸ìš”', yomi: 'itterasshai', set: 1 }, { jp: 'ãŸã ã„ã¾', mean: 'ë‹¤ë…€ì™”ìŠµë‹ˆë‹¤', yomi: 'tadaima', set: 1 }, { jp: 'ãŠã‹ãˆã‚Š', mean: 'ì–´ì„œ ì™€ìš” (ê·€ê°€)', yomi: 'okaeri', set: 1 }, { jp: 'ã¯ã˜ã‚ã¾ã—ã¦', mean: 'ì²˜ìŒ ëµ™ê² ìŠµë‹ˆë‹¤', yomi: 'hajimemashite', set: 1 }, { jp: 'ãªã«', mean: 'ë¬´ì—‡', yomi: 'nani', set: 1 }, { jp: 'ã ã‚Œ', mean: 'ëˆ„êµ¬', yomi: 'dare', set: 1 }, { jp: 'ã„ã¤', mean: 'ì–¸ì œ', yomi: 'itsu', set: 1 }, { jp: 'ã©ã“', mean: 'ì–´ë””', yomi: 'doko', set: 1 }, { jp: 'ã©ã†ã—ã¦', mean: 'ì–´ì§¸ì„œ (ì™œ)', yomi: 'doushite', set: 1 },
            // Set 2: ì˜ë¬¸ì‚¬ & ë¶€ì‚¬ 1 (21-40)
            { jp: 'ãªãœ', mean: 'ì™œ (Why)', yomi: 'naze', set: 2 }, { jp: 'ã©ã†', mean: 'ì–´ë–»ê²Œ/ì–´ë•Œ', yomi: 'dou', set: 2 }, { jp: 'ã©ã‚“ãª', mean: 'ì–´ë–¤', yomi: 'donna', set: 2 }, { jp: 'ã©ã¡ã‚‰', mean: 'ì–´ëŠ ìª½', yomi: 'dochira', set: 2 }, { jp: 'ã„ãã‚‰', mean: 'ì–¼ë§ˆ', yomi: 'ikura', set: 2 }, { jp: 'ã¨ã¦ã‚‚', mean: 'ë§¤ìš° (ì•„ì£¼)', yomi: 'totemo', set: 2 }, { jp: 'ãŸãã•ã‚“', mean: 'ë§ì´', yomi: 'takusan', set: 2 }, { jp: 'ã™ã“ã—', mean: 'ì¡°ê¸ˆ (ì ê²Œ)', yomi: 'sukoshi', set: 2 }, { jp: 'ã¡ã‚‡ã£ã¨', mean: 'ì ê¹/ì¢€', yomi: 'chotto', set: 2 }, { jp: 'ã„ã¤ã‚‚', mean: 'ì–¸ì œë‚˜ (í•­ìƒ)', yomi: 'itsumo', set: 2 }, { jp: 'ã‚ˆã', mean: 'ìì£¼/ì˜', yomi: 'yoku', set: 2 }, { jp: 'ã¨ãã©ã', mean: 'ê°€ë”', yomi: 'tokidoki', set: 2 }, { jp: 'ã¾ã ', mean: 'ì•„ì§', yomi: 'mada', set: 2 }, { jp: 'ã‚‚ã†', mean: 'ë²Œì¨/ì´ë¯¸', yomi: 'mou', set: 2 }, { jp: 'ã ã„ãŸã„', mean: 'ëŒ€ê°œ (ëŒ€ì²´ë¡œ)', yomi: 'daitai', set: 2 }, { jp: 'ãŸã¶ã‚“', mean: 'ì•„ë§ˆ', yomi: 'tabun', set: 2 }, { jp: 'ã‚†ã£ãã‚Š', mean: 'ì²œì²œíˆ', yomi: 'yukkuri', set: 2 }, { jp: 'ã™ã', mean: 'ê³§/ë°”ë¡œ', yomi: 'sugu', set: 2 }, { jp: 'ãœã‚“ã¶', mean: 'ì „ë¶€', yomi: 'zenbu', set: 2 }, { jp: 'ã¯ã˜ã‚ã¦', mean: 'ì²˜ìŒìœ¼ë¡œ', yomi: 'hajimete', set: 2 },
            // Set 3: ë¶€ì‚¬ 2 & ì ‘ì†ì‚¬ & ê¸°íƒ€ (41-60)
            { jp: 'ã¾ãŸ', mean: 'ë˜ (ë‹¤ì‹œ)', yomi: 'mata', set: 3 }, { jp: 'ã‚‚ã£ã¨', mean: 'ë” (More)', yomi: 'motto', set: 3 }, { jp: 'ã„ã¡ã°ã‚“', mean: 'ê°€ì¥ (ì œì¼)', yomi: 'ichiban', set: 3 }, { jp: 'ã ã‚“ã ã‚“', mean: 'ì ì ', yomi: 'dandan', set: 3 }, { jp: 'ã»ã‚“ã¨ã†ã«', mean: 'ì •ë§ë¡œ', yomi: 'hontouni', set: 3 }, { jp: 'ãã—ã¦', mean: 'ê·¸ë¦¬ê³ ', yomi: 'soshite', set: 3 }, { jp: 'ã—ã‹ã—', mean: 'ê·¸ëŸ¬ë‚˜', yomi: 'shikashi', set: 3 }, { jp: 'ã§ã‚‚', mean: 'í•˜ì§€ë§Œ', yomi: 'demo', set: 3 }, { jp: 'ãã‚Œã‹ã‚‰', mean: 'ê·¸ ë‹¤ìŒì—', yomi: 'sorekara', set: 3 }, { jp: 'ã ã‹ã‚‰', mean: 'ê·¸ë˜ì„œ', yomi: 'dakara', set: 3 }, { jp: 'ã¯ã„', mean: 'ë„¤ (ì˜ˆ)', yomi: 'hai', set: 3 }, { jp: 'ã„ã„ãˆ', mean: 'ì•„ë‹ˆìš”', yomi: 'iie', set: 3 }, { jp: 'ã‚ã‚Œ', mean: 'ì €ê²ƒ', yomi: 'are', set: 3 }, { jp: 'ã“ã‚Œ', mean: 'ì´ê²ƒ', yomi: 'kore', set: 3 }, { jp: 'ãã‚Œ', mean: 'ê·¸ê²ƒ', yomi: 'sore', set: 3 }, { jp: 'ã‚¢ãƒ‘ãƒ¼ãƒˆ', mean: 'ì•„íŒŒíŠ¸', yomi: 'apato', set: 3 }, { jp: 'ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼', mean: 'ì—˜ë¦¬ë² ì´í„°', yomi: 'erebeta', set: 3 }, { jp: 'ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚¿ãƒ¼', mean: 'ì—ìŠ¤ì»¬ë ˆì´í„°', yomi: 'esukareta', set: 3 }, { jp: 'ãƒ›ãƒ†ãƒ«', mean: 'í˜¸í…”', yomi: 'hoteru', set: 3 }, { jp: 'ã‚¿ã‚¯ã‚·ãƒ¼', mean: 'íƒì‹œ', yomi: 'takushi', set: 3 },
            // Set 4: ê°€íƒ€ì¹´ë‚˜ 2 (61-80)
            { jp: 'ãƒã‚¹', mean: 'ë²„ìŠ¤', yomi: 'basu', set: 4 }, { jp: 'ãƒ‹ãƒ¥ãƒ¼ã‚¹', mean: 'ë‰´ìŠ¤', yomi: 'nyusu', set: 4 }, { jp: 'ãƒ©ã‚¸ã‚ª', mean: 'ë¼ë””ì˜¤', yomi: 'rajio', set: 4 }, { jp: 'ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼', mean: 'íŒŒí‹°', yomi: 'pati', set: 4 }, { jp: 'ã‚³ãƒ³ãƒ“ãƒ‹', mean: 'í¸ì˜ì ', yomi: 'konbini', set: 4 }, { jp: 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', mean: 'ë ˆìŠ¤í† ë‘', yomi: 'resutoran', set: 4 }, { jp: 'ã‚³ãƒ¼ãƒ’ãƒ¼', mean: 'ì»¤í”¼', yomi: 'kohi', set: 4 }, { jp: 'ã‚¸ãƒ¥ãƒ¼ã‚¹', mean: 'ì£¼ìŠ¤', yomi: 'jusu', set: 4 }, { jp: 'ãƒ“ãƒ¼ãƒ«', mean: 'ë§¥ì£¼', yomi: 'biru', set: 4 }, { jp: 'ã‚±ãƒ¼ã‚­', mean: 'ì¼€ì´í¬', yomi: 'keki', set: 4 }, { jp: 'ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆ', mean: 'ì´ˆì½œë¦¿', yomi: 'chokoreto', set: 4 }, { jp: 'ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ ', mean: 'ì•„ì´ìŠ¤í¬ë¦¼', yomi: 'aisukurimu', set: 4 }, { jp: 'ã‚·ãƒ£ãƒ„', mean: 'ì…”ì¸ ', yomi: 'shatsu', set: 4 }, { jp: 'ã‚¹ã‚«ãƒ¼ãƒˆ', mean: 'ìŠ¤ì»¤íŠ¸(ì¹˜ë§ˆ)', yomi: 'sukato', set: 4 }, { jp: 'ã‚ºãƒœãƒ³', mean: 'ë°”ì§€', yomi: 'zubon', set: 4 }, { jp: 'ãƒã‚±ãƒƒãƒˆ', mean: 'ì£¼ë¨¸ë‹ˆ', yomi: 'poketto', set: 4 }, { jp: 'ãƒœã‚¿ãƒ³', mean: 'ë‹¨ì¶”/ë²„íŠ¼', yomi: 'botan', set: 4 }, { jp: 'ãƒ‰ã‚¢', mean: 'ë¬¸(door)', yomi: 'doa', set: 4 }, { jp: 'ãƒ™ãƒƒãƒ‰', mean: 'ì¹¨ëŒ€', yomi: 'beddo', set: 4 }, { jp: 'ãƒ†ãƒ¼ãƒ–ãƒ«', mean: 'í…Œì´ë¸”', yomi: 'teburu', set: 4 },
            // Set 5: ìˆ˜ì‚¬ & ì¡°ìˆ˜ì‚¬ (81-100)
            { jp: 'ã²ã¨ã¤', mean: 'í•œ ê°œ', yomi: 'hitotsu', set: 5 }, { jp: 'ãµãŸã¤', mean: 'ë‘ ê°œ', yomi: 'futatsu', set: 5 }, { jp: 'ã¿ã£ã¤', mean: 'ì„¸ ê°œ', yomi: 'mittsu', set: 5 }, { jp: 'ã²ã¨ã‚Š', mean: 'í•œ ëª…', yomi: 'hitori', set: 5 }, { jp: 'ãµãŸã‚Š', mean: 'ë‘ ëª…', yomi: 'futari', set: 5 }, { jp: 'ã„ã¡ã«ã¡', mean: 'í•˜ë£¨', yomi: 'ichinichi', set: 5 }, { jp: 'ãµã¤ã‹', mean: 'ì´í‹€', yomi: 'futsuka', set: 5 }, { jp: 'ã¿ã£ã‹', mean: 'ì‚¬í˜', yomi: 'mikka', set: 5 }, { jp: 'ã‚ˆã†ã‹', mean: '8ì¼', yomi: 'youka', set: 5 }, { jp: 'ã“ã“ã®ã‹', mean: '9ì¼', yomi: 'kokonoka', set: 5 }, { jp: 'ã¨ãŠã‹', mean: '10ì¼', yomi: 'tooka', set: 5 }, { jp: 'ã¯ã¤ã‹', mean: '20ì¼', yomi: 'hatsuka', set: 5 }, { jp: 'ã„ã¡ãŒã¤', mean: '1ì›”', yomi: 'ichigatsu', set: 5 }, { jp: 'ãªã‚“ã˜', mean: 'ëª‡ ì‹œ', yomi: 'nanji', set: 5 }, { jp: 'ãªã‚“ã·ã‚“', mean: 'ëª‡ ë¶„', yomi: 'nanpun', set: 5 }, { jp: 'ãªã‚“ã‚ˆã†ã³', mean: 'ë¬´ìŠ¨ ìš”ì¼', yomi: 'nanyoubi', set: 5 }, { jp: 'ãªã‚“ã•ã„', mean: 'ëª‡ ì‚´', yomi: 'nansai', set: 5 }, { jp: 'ãªã‚“ã«ã‚“', mean: 'ëª‡ ëª…', yomi: 'nannin', set: 5 }, { jp: 'ãªã‚“ã¼ã‚“', mean: 'ëª‡ ìë£¨/ë³‘', yomi: 'nanbon', set: 5 }, { jp: 'ãªã‚“ã¾ã„', mean: 'ëª‡ ì¥', yomi: 'nanmai', set: 5 }
        ];

        let quizDeck_3 = [];
        let currentQuiz_3 = null;
        let quizScore_3 = 0;
        let quizCorrectCount_3 = 0;
        let quizTotalCount_3 = 0;
        let quizWrongAnswers_3 = []; 
        let quizStartTime_3 = 0; 
        let quizMistakeCount_3 = 0; 
        let currentSet_3 = 1;

        const quizWrapper_3 = document.getElementById('jp-wordquiz-wrapper-3');
        const qText_3 = document.getElementById('quizQuestionText_3');
        const qHint_3 = document.getElementById('quizHintBox_3');
        const qOptions_3 = document.getElementById('quizOptionsArea_3');
        const qProgress_3 = document.getElementById('quizProgress_3');
        const qScore_3 = document.getElementById('quizScore_3');
        const qResult_3 = document.getElementById('quizResultScreen_3');
        const qMistakeList_3 = document.getElementById('quizMistakeList_3');
        const qSubtitle_3 = document.getElementById('setSubtitle_3');

        function setQuizSize_3(size) {
            quizWrapper_3.classList.remove('size-small', 'size-large');
            const buttons = quizWrapper_3.querySelectorAll('.size-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (size === 'small') {
                quizWrapper_3.classList.add('size-small');
                quizWrapper_3.querySelector("button[onclick=\"setQuizSize_3('small')\"]").classList.add('active');
            } else if (size === 'large') {
                quizWrapper_3.classList.add('size-large');
                quizWrapper_3.querySelector("button[onclick=\"setQuizSize_3('large')\"]").classList.add('active');
            } else {
                document.getElementById('btnQuizMedium_3').classList.add('active');
            }
        }

        function changeSet_3(set) {
            currentSet_3 = set;
            const setBtns = quizWrapper_3.querySelectorAll('.set-btn');
            setBtns.forEach(btn => btn.classList.remove('active'));
            
            if(set === 'all') {
                setBtns[5].classList.add('active');
                qSubtitle_3.innerText = `[ ì „ì²´ ë„ì „ : ì´ ${wordQuizDB_3.length}ë‹¨ì–´ ]`;
            } else {
                setBtns[set-1].classList.add('active');
                qSubtitle_3.innerText = `[ Set ${set} : ë‹¨ì–´ ${getSetRange_3(set)} ]`;
            }
            initQuizGame_3();
        }

        function getSetRange_3(set) {
            const start = (set - 1) * 20 + 1;
            const end = set * 20;
            return `${start}~${end}`;
        }

        function shuffleQuiz_3(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function initQuizGame_3() {
            let filteredDB = [];
            if (currentSet_3 === 'all') {
                filteredDB = [...wordQuizDB_3];
            } else {
                filteredDB = wordQuizDB_3.filter(item => item.set === currentSet_3);
            }

            quizDeck_3 = shuffleQuiz_3(filteredDB); 
            quizTotalCount_3 = quizDeck_3.length; 
            quizScore_3 = 0;
            quizCorrectCount_3 = 0;
            quizWrongAnswers_3 = [];
            qScore_3.innerText = quizScore_3;
            updateQuizProgress_3();
            qResult_3.style.display = 'none';
            nextQuizQuestion_3();
        }

        function updateQuizProgress_3() {
            qProgress_3.innerText = `${quizCorrectCount_3} / ${quizTotalCount_3}`;
        }

        function nextQuizQuestion_3() {
            if (quizDeck_3.length === 0) {
                endQuizGame_3();
                return;
            }
            qOptions_3.classList.remove('disabled-area');
            quizMistakeCount_3 = 0; 
            currentQuiz_3 = quizDeck_3.pop();
            qText_3.innerText = currentQuiz_3.jp;
            qHint_3.innerText = ""; 
            const options = generateQuizOptions_3(currentQuiz_3);
            renderQuizButtons_3(options);
            quizStartTime_3 = Date.now();
        }

        function generateQuizOptions_3(correctItem) {
            const otherWords = wordQuizDB_3.filter(w => w.jp !== correctItem.jp);
            const distractors = shuffleQuiz_3(otherWords).slice(0, 4);
            const finalOptions = [...distractors, correctItem];
            return shuffleQuiz_3(finalOptions);
        }

        function renderQuizButtons_3(options) {
            qOptions_3.innerHTML = '';
            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.mean;
                btn.onclick = () => checkQuizAnswer_3(btn, opt);
                qOptions_3.appendChild(btn);
            });
        }

        function checkQuizAnswer_3(btn, selectedOpt) {
            if (selectedOpt.jp === currentQuiz_3.jp) {
                qOptions_3.classList.add('disabled-area'); 
                btn.classList.add('correct');
                
                if (quizMistakeCount_3 === 0) {
                    const endTime = Date.now();
                    const timeTaken = (endTime - quizStartTime_3) / 1000; 
                    const point = Math.max(20, Math.floor(100 - (timeTaken * 5))); 
                    quizScore_3 += point;
                    quizCorrectCount_3++; 
                } else {
                    quizCorrectCount_3++; 
                }

                qScore_3.innerText = quizScore_3;
                updateQuizProgress_3(); 
                setTimeout(nextQuizQuestion_3, 500); 
            } else {
                btn.classList.add('wrong');
                btn.disabled = true; 
                
                if (quizMistakeCount_3 === 0) {
                    quizMistakeCount_3++;
                    qHint_3.innerText = `ğŸ’¡ íŒíŠ¸: ${currentQuiz_3.yomi}`;
                    if (!quizWrongAnswers_3.some(w => w.jp === currentQuiz_3.jp)) {
                        quizWrongAnswers_3.push(currentQuiz_3);
                    }
                } else {
                    qOptions_3.classList.add('disabled-area'); 
                    const allBtns = qOptions_3.querySelectorAll('.option-btn');
                    allBtns.forEach(b => {
                        if (b.innerText === currentQuiz_3.mean) b.classList.add('correct');
                    });
                    setTimeout(nextQuizQuestion_3, 1500);
                }
            }
        }

        function endQuizGame_3() {
            document.getElementById('finalQuizScore_3').innerText = quizScore_3;
            document.getElementById('finalQuizProgress_3').innerText = `${quizCorrectCount_3} / ${quizTotalCount_3}`;
            qMistakeList_3.innerHTML = '';
            if (quizWrongAnswers_3.length === 0) {
                qMistakeList_3.innerHTML = '<div style="color:#2ecc71; text-align:center; padding:20px;">ğŸ† ì™„ë²½í•©ë‹ˆë‹¤!</div>';
            } else {
                quizWrongAnswers_3.forEach(w => {
                    const item = document.createElement('div');
                    item.className = 'mistake-item';
                    item.innerHTML = `<span class="mistake-jp">${w.jp}</span> (${w.yomi}) : ${w.mean}`;
                    qMistakeList_3.appendChild(item);
                });
            }
            qResult_3.style.display = 'flex';
        }

        function speak_3() {
            if (!('speechSynthesis' in window)) {
                alert("ì´ ë¸Œë¼ìš°ì €ëŠ” ìŒì„± ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
                return;
            }
            const text = currentQuiz_3.jp;
            const utt = new SpeechSynthesisUtterance(text);
            utt.lang = 'ja-JP';
            utt.rate = 0.9; 

            const voices = window.speechSynthesis.getVoices();
            const jaVoice = voices.find(v => v.lang.includes('ja') || v.lang.includes('JP'));
            if (jaVoice) utt.voice = jaVoice;

            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utt);
        }

        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = function() { 
                window.speechSynthesis.getVoices(); 
            };
        }

        initQuizGame_3();
    </script>
</body>
</html>
